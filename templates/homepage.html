{% extends 'base.html' %}
{% block title %} Movie Journal {% endblock %}
{% block navbar1 %}
<li class="nav-item">
    <a class="nav-link" href='/add-movie'>Add Movie</a>
</li>
<li class="nav-item">
    <a class="nav-link" href='#'>Wish List</a>
</li>

{% endblock %}
{% block content %}
<p><h2>My Watched Movies List</h2></p>

<table class="table table-hover table-dark">
    <thead class="thead-lihjt">
    <th scope="col">Poster</th>
    <th scope="col">Movie Title</th>
    <th scope="col">Release Date</th>
    <th scope="col">Plot</th>
    <th scope="col">Genre</th>
    <th scope="col">IMDb Rating</th>
    <th scope="col">My Rating</th>
    <th scope="col">My Review</th>
    <th scope="col">Review Date</th>

</thead>

    {% for movie_review in movies_reviews %}
    <tr>
        {% with %}
        <!--  -->
        {% set movie = movie_review[0] %} 
        {% set review = movie_review[1] %}
        <td><img src='{{ movie.poster_img }}' width='50' hight='50'></td>
        <td><a href=' {{ movie.movie_url }}'>{{ movie.title}} </td>
        <td>{{ movie.usa_release_date }}</td>
        <td>{{ movie.plot }}</td>
        
        <td>
        {% for genre in movie.genres %}
        {{ genre.genre_title }},
        {% endfor %}</td>

        <td>{{movie.imdb_rating }}</td>
        <td  class='rating'>{{review.rating }}</td>
        <td  class='review'>{{review.review }}</td>
        <td class='date_review'>{{review.date_review }}</td>

        <!-- Trigger/Open The Modal -->
        <td><button  type='button' class='btn' data-toggle='modal' data-target='#modal-edit{{movie.movie_id}}' value='{{ movie.movie_id }}' >Edit Review </button>
        
        <!-- EDIT REVIEW POPUP WINDOW-->

        <!-- The Modal -->
        <div class="modal" id="modal-edit{{movie.movie_id}}" role='dialog'>

        <!-- Modal content -->
        <div class="modal-dialog">
            <div class='modal-content'>
                
                <div class='modal-header'>
            <button type='button' class='close' data-dismiss='modal'>X</button>
                    <h4 class='modal-title'> Edit your review for {{movie.title}}</h4>
                    </div>
                <div class='modal-body'>
                <p>
                    <form>
                    <input type='hidden' name='movie_id' value='{{movie.movie_id}}'>
                    
                    Edit rating: <input class="rating rating-loading" id='new_rating' type='number' name ='rating' value='{{ review.rating }}' data-min="1" data-max="5" data-step="1"><br >
                    Edit review: 
                    <textarea id='new_review' name='review' value=>{{ review.review }}</textarea><br>
                    <button type='button' id='confirm-edit' data-dismiss='modal'>Confirm</button>
                    <button type='button'  data-dismiss='modal'>Cancel</button>
                    </form>
                        </p>
                </div> <!-- end .model-body-->
            </div> <!-- end .model-content -->
        </div> <!--end .model-dialog  -->
        </div> <!--end .model -->

        <!-- END POPUP MODEL -->
          
        <td><button  id='deleteMovie' value='{{ movie.movie_id }}'>Delete </button>

        {% endwith %}
    </tr>
       
    {% endfor %}
    
</table>

<!-- <link href='static/css/homepage.css' rel='stylesheet'> -->

<script src='http://code.jquery.com/jquery.js'></script>
<script src ='/static/JS/edit_review.js'></script>

<script src ='/static/JS/delete_from_journal.js'></script>




{% endblock %}